<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="jakarta.faces.facelets">

<h:head>
    <title>Manage Voters</title>
    <link href="CSS/voters.css" rel="stylesheet" type="text/css"/>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        /* voters.css */
body {
    font-family: Arial, sans-serif;
    background-color: #f4f6f8;
    padding: 20px;
    margin: 0;
}

.votersTable {
    width: 100%;
    margin: 20px auto;
    border-collapse: collapse;
    background: white;
}

.votersTable th {
    background-color: #0056b3;
    color: white;
    padding: 10px;
}

.votersTable td {
    border: 1px solid #ccc;
    padding: 8px;
    text-align: center;
}

.btn-approve {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}

.btn-reject {
    background-color: #dc3545;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}/* NAVBAR CONTAINER */
.navbar {
    width: 100%;
    padding: 12px 28px;
    display: flex;
    justify-content: space-between;
    align-items: center;

    background: rgba(255, 255, 255, 0.45);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);

    border-radius: 14px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    margin-bottom: 20px;
}

/* TITLE */
.nav-title {
    font-size: 22px;
    font-weight: 600;
    color: #003d80;
}

/* LINKS CONTAINER */
.nav-links {
    display: flex;
    gap: 28px;
}

/* LINKS */
.nav-links a {
    text-decoration: none;
    font-size: 15px;
    color: #333;
    font-weight: 500;

    padding: 6px 12px;
    border-radius: 8px;
    transition: 0.25s ease;
}

/* HOVER ANIMATION */
.nav-links a:hover {
    background: #0056b3;
    color: white;
    transform: translateY(-2px);
}

/* ACTIVE PAGE */
.nav-links a.active {
    background: #0056b3;
    color: white;
}



    </style>
    
</h:head>

<h:body>
<h:form id="voterForm">
    <!-- NAVBAR -->
<div class="navbar">
    

    <div class="nav-links">
        <a href="ManageVoters.jsf" target="_self">New Requests</a>
        <a href="VotersList.jsf" target="_self">Voter List</a>
<!--        <a href="approvedVoters.xhtml" target="_self">Done</a>-->
    </div>
</div>


    <!-- SweetAlert -->
    <h:panelGroup id="alertPanel">
        <h:outputScript rendered="#{not empty voterModule.alertMessage}">
            Swal.fire({
                icon: 'success',
                title: '#{voterModule.alertMessage}',
                showConfirmButton: false,
                timer: 2000
            });
            #{voterModule.clearAlert()}
        </h:outputScript>
    </h:panelGroup>

    <h2>New Voter Requests</h2>

    <table class="votersTable">
<thead>
    <tr>
        
        <th>Image</th>
        <th>Name</th>
        <th>Mobile</th>
        <th>Email</th>
        <th>Aadhar No</th>
        <th>Aadhar File</th>
        <th>DOB</th>
        <th>City</th>
        <th>Pincode</th>
        <th>Address</th>
        <th>Apply Date</th>
        <th>Status</th>
        <th colspan="2">Actions</th>
    </tr>
</thead>

<tbody>
<ui:repeat value="#{voterModule.voters}" var="v">
    <tr>

        

        <!-- VOTER IMAGE -->
        <td>
            <img src="#{v.voterImage}" 
                 style="width:55px;height:55px;border-radius:6px;border:1px solid #aaa;" />
        </td>

        <!-- NAME -->
        <td>#{v.voterName}</td>

        <!-- MOBILE -->
        <td>#{v.mobileNumber}</td>

        <!-- EMAIL -->
        <td>#{v.emailId}</td>

        <!-- AADHAR NUMBER -->
        <td>#{v.adharNumber}</td>

        <!-- AADHAR FILE VIEW ICON -->
        <td>
            <a href="#{v.adharFile}" target="_blank" title="View Aadhar">
                <span style="font-size:20px;cursor:pointer;">&#128065;</span>
            </a>
        </td>

        <!-- DOB -->
        <td>
            <h:outputText value="#{v.dob}">
                <f:convertDateTime pattern="dd-MM-yyyy"/>
            </h:outputText>
        </td>

        <!-- CITY -->
        <td>#{v.city}</td>

        <!-- PINCODE -->
        <td>#{v.pincode}</td>

        <!-- ADDRESS -->
        <td>#{v.address}</td>

        <!-- APPLY DATE -->
        <td>
            <h:outputText value="#{v.applyDate}">
                <f:convertDateTime pattern="dd-MM-yyyy"/>
            </h:outputText>
        </td>

        <!-- STATUS -->
        <td>
            <h:outputText value="#{v.status eq 1 ? 'Approved' : 'Pending'}"/>
        </td>

        <!-- APPROVE BUTTON -->
        <td>
            <h:commandButton value="Approve"
                             action="#{voterModule.approve(v.voterId)}"
                             styleClass="btn-approve"
                             rendered="#{v.status eq 0}">
                <f:ajax render="voterForm"/>
            </h:commandButton>
        </td>

        <!-- REJECT BUTTON -->
        <td>
            <h:commandButton value="Reject"
                             action="#{voterModule.reject(v.voterId)}"
                             styleClass="btn-reject">
                <f:ajax render="voterForm"/>
            </h:commandButton>
        </td>

    </tr>
</ui:repeat>
</tbody>
</table>

</h:form>
</h:body>
</html>
